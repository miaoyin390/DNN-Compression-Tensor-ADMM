# -*- coding:utf-8 -*-
# 
# Author: MIAO YIN
# Time: 2021/11/19 18:39


class HyperParamsDictRatio2x:
    depth = 12
    num_heads = 6
    embed_dim = 384
    tt_shapes = {
        'blocks.0.attn.qkv.weight':   (36, 32, 16, 24),
        'blocks.0.attn.proj.weight':  (24, 16, 16, 24),
        'blocks.0.mlp.fc1.weight':    (32, 48, 16, 24),
        'blocks.0.mlp.fc2.weight':    (24, 16, 48, 32),
        'blocks.1.attn.qkv.weight':   (36, 32, 16, 24),
        'blocks.1.attn.proj.weight':  (24, 16, 16, 24),
        'blocks.1.mlp.fc1.weight':    (32, 48, 16, 24),
        'blocks.1.mlp.fc2.weight':    (24, 16, 48, 32),
        'blocks.2.attn.qkv.weight':   (36, 32, 16, 24),
        'blocks.2.attn.proj.weight':  (24, 16, 16, 24),
        'blocks.2.mlp.fc1.weight':    (32, 48, 16, 24),
        'blocks.2.mlp.fc2.weight':    (24, 16, 48, 32),
        'blocks.3.attn.qkv.weight':   (36, 32, 16, 24),
        'blocks.3.attn.proj.weight':  (24, 16, 16, 24),
        'blocks.3.mlp.fc1.weight':    (32, 48, 16, 24),
        'blocks.3.mlp.fc2.weight':    (24, 16, 48, 32),
        'blocks.4.attn.qkv.weight':   (36, 32, 16, 24),
        'blocks.4.attn.proj.weight':  (24, 16, 16, 24),
        'blocks.4.mlp.fc1.weight':    (32, 48, 16, 24),
        'blocks.4.mlp.fc2.weight':    (24, 16, 48, 32),
        'blocks.5.attn.qkv.weight':   (36, 32, 16, 24),
        'blocks.5.attn.proj.weight':  (24, 16, 16, 24),
        'blocks.5.mlp.fc1.weight':    (32, 48, 16, 24),
        'blocks.5.mlp.fc2.weight':    (24, 16, 48, 32),
        'blocks.6.attn.qkv.weight':   (36, 32, 16, 24),
        'blocks.6.attn.proj.weight':  (24, 16, 16, 24),
        'blocks.6.mlp.fc1.weight':    (32, 48, 16, 24),
        'blocks.6.mlp.fc2.weight':    (24, 16, 48, 32),
        'blocks.7.attn.qkv.weight':   (36, 32, 16, 24),
        'blocks.7.attn.proj.weight':  (24, 16, 16, 24),
        'blocks.7.mlp.fc1.weight':    (32, 48, 16, 24),
        'blocks.7.mlp.fc2.weight':    (24, 16, 48, 32),
        'blocks.8.attn.qkv.weight':   (36, 32, 16, 24),
        'blocks.8.attn.proj.weight':  (24, 16, 16, 24),
        'blocks.8.mlp.fc1.weight':    (32, 48, 16, 24),
        'blocks.8.mlp.fc2.weight':    (24, 16, 48, 32),
        'blocks.9.attn.qkv.weight':   (36, 32, 16, 24),
        'blocks.9.attn.proj.weight':  (24, 16, 16, 24),
        'blocks.9.mlp.fc1.weight':    (32, 48, 16, 24),
        'blocks.9.mlp.fc2.weight':    (24, 16, 48, 32),
        'blocks.10.attn.qkv.weight':  (36, 32, 16, 24),
        'blocks.10.attn.proj.weight': (24, 16, 16, 24),
        'blocks.10.mlp.fc1.weight':   (32, 48, 16, 24),
        'blocks.10.mlp.fc2.weight':   (24, 16, 48, 32),
        'blocks.11.attn.qkv.weight':  (36, 32, 16, 24),
        'blocks.11.attn.proj.weight': (24, 16, 16, 24),
        'blocks.11.mlp.fc1.weight':   (32, 48, 16, 24),
        'blocks.11.mlp.fc2.weight':   (24, 16, 48, 32),
    }

    ranks = {
        # state_dict key: (output channel, input channel)
        'blocks.0.attn.qkv.weight':   (1, 32, 182, 22, 1),
        'blocks.0.attn.proj.weight':  (1, 22, 180, 22, 1),
        'blocks.0.mlp.fc1.weight':    (1, 30, 180, 22, 1),
        'blocks.0.mlp.fc2.weight':    (1, 22, 180, 30, 1),
        'blocks.1.attn.qkv.weight':   (1, 25, 170, 18, 1),
        'blocks.1.attn.proj.weight':  (1, 18, 170, 18, 1),
        'blocks.1.mlp.fc1.weight':    (1, 25, 170, 18, 1),
        'blocks.1.mlp.fc2.weight':    (1, 18, 170, 25, 1),
        'blocks.2.attn.qkv.weight':   (1, 28, 170, 20, 1),
        'blocks.2.attn.proj.weight':  (1, 20, 170, 20, 1),
        'blocks.2.mlp.fc1.weight':    (1, 28, 170, 20, 1),
        'blocks.2.mlp.fc2.weight':    (1, 20, 170, 28, 1),
        'blocks.3.attn.qkv.weight':   (1, 28, 160, 20, 1),
        'blocks.3.attn.proj.weight':  (1, 20, 160, 20, 1),
        'blocks.3.mlp.fc1.weight':    (1, 28, 160, 20, 1),
        'blocks.3.mlp.fc2.weight':    (1, 20, 160, 28, 1),
        'blocks.4.attn.qkv.weight':   (1, 28, 160, 20, 1),
        'blocks.4.attn.proj.weight':  (1, 20, 160, 20, 1),
        'blocks.4.mlp.fc1.weight':    (1, 28, 160, 20, 1),
        'blocks.4.mlp.fc2.weight':    (1, 20, 160, 28, 1),
        'blocks.5.attn.qkv.weight':   (1, 28, 150, 20, 1),
        'blocks.5.attn.proj.weight':  (1, 20, 150, 20, 1),
        'blocks.5.mlp.fc1.weight':    (1, 28, 150, 20, 1),
        'blocks.5.mlp.fc2.weight':    (1, 20, 150, 28, 1),
        'blocks.6.attn.qkv.weight':   (1, 28, 150, 20, 1),
        'blocks.6.attn.proj.weight':  (1, 20, 150, 20, 1),
        'blocks.6.mlp.fc1.weight':    (1, 28, 150, 20, 1),
        'blocks.6.mlp.fc2.weight':    (1, 20, 150, 28, 1),
        'blocks.7.attn.qkv.weight':   (1, 28, 150, 20, 1),
        'blocks.7.attn.proj.weight':  (1, 20, 150, 20, 1),
        'blocks.7.mlp.fc1.weight':    (1, 28, 150, 20, 1),
        'blocks.7.mlp.fc2.weight':    (1, 20, 150, 28, 1),
        'blocks.8.attn.qkv.weight':   (1, 28, 150, 20, 1),
        'blocks.8.attn.proj.weight':  (1, 20, 150, 20, 1),
        'blocks.8.mlp.fc1.weight':    (1, 28, 150, 20, 1),
        'blocks.8.mlp.fc2.weight':    (1, 20, 150, 28, 1),
        'blocks.9.attn.qkv.weight':   (1, 28, 140, 20, 1),
        'blocks.9.attn.proj.weight':  (1, 20, 140, 20, 1),
        'blocks.9.mlp.fc1.weight':    (1, 28, 140, 20, 1),
        'blocks.9.mlp.fc2.weight':    (1, 20, 140, 28, 1),
        'blocks.10.attn.qkv.weight':  (1, 28, 140, 20, 1),
        'blocks.10.attn.proj.weight': (1, 20, 140, 20, 1),
        'blocks.10.mlp.fc1.weight':   (1, 28, 140, 20, 1),
        'blocks.10.mlp.fc2.weight':   (1, 20, 140, 28, 1),
        'blocks.11.attn.qkv.weight':  (1, 28, 130, 20, 1),
        'blocks.11.attn.proj.weight': (1, 20, 130, 20, 1),
        'blocks.11.mlp.fc1.weight':   (1, 28, 130, 20, 1),
        'blocks.11.mlp.fc2.weight':   (1, 20, 130, 28, 1),
    }