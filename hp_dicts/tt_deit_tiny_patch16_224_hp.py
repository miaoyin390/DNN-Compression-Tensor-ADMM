# -*- coding:utf-8 -*-
# 
# Author: MIAO YIN
# Time: 2021/10/11 21:00


class HyperParamsDictRatio2x:
    depth = 12
    num_heads = 3
    embed_dim = 192
    tt_shapes = {
        'blocks.0.attn.qkv.weight':   (24, 24, 12, 16),
        'blocks.0.attn.proj.weight':  (16, 12, 12, 16),
        'blocks.0.mlp.fc1.weight':    (32, 24, 12, 16),
        'blocks.0.mlp.fc2.weight':    (16, 12, 24, 32),
        'blocks.1.attn.qkv.weight':   (24, 24, 12, 16),
        'blocks.1.attn.proj.weight':  (16, 12, 12, 16),
        'blocks.1.mlp.fc1.weight':    (32, 24, 12, 16),
        'blocks.1.mlp.fc2.weight':    (16, 12, 24, 32),
        'blocks.2.attn.qkv.weight':   (24, 24, 12, 16),
        'blocks.2.attn.proj.weight':  (16, 12, 12, 16),
        'blocks.2.mlp.fc1.weight':    (32, 24, 12, 16),
        'blocks.2.mlp.fc2.weight':    (16, 12, 24, 32),
        'blocks.3.attn.qkv.weight':   (24, 24, 12, 16),
        'blocks.3.attn.proj.weight':  (16, 12, 12, 16),
        'blocks.3.mlp.fc1.weight':    (32, 24, 12, 16),
        'blocks.3.mlp.fc2.weight':    (16, 12, 24, 32),
        'blocks.4.attn.qkv.weight':   (24, 24, 12, 16),
        'blocks.4.attn.proj.weight':  (16, 12, 12, 16),
        'blocks.4.mlp.fc1.weight':    (32, 24, 12, 16),
        'blocks.4.mlp.fc2.weight':    (16, 12, 24, 32),
        'blocks.5.attn.qkv.weight':   (24, 24, 12, 16),
        'blocks.5.attn.proj.weight':  (16, 12, 12, 16),
        'blocks.5.mlp.fc1.weight':    (32, 24, 12, 16),
        'blocks.5.mlp.fc2.weight':    (16, 12, 24, 32),
        'blocks.6.attn.qkv.weight':   (24, 24, 12, 16),
        'blocks.6.attn.proj.weight':  (16, 12, 12, 16),
        'blocks.6.mlp.fc1.weight':    (32, 24, 12, 16),
        'blocks.6.mlp.fc2.weight':    (16, 12, 24, 32),
        'blocks.7.attn.qkv.weight':   (24, 24, 12, 16),
        'blocks.7.attn.proj.weight':  (16, 12, 12, 16),
        'blocks.7.mlp.fc1.weight':    (32, 24, 12, 16),
        'blocks.7.mlp.fc2.weight':    (16, 12, 24, 32),
        'blocks.8.attn.qkv.weight':   (24, 24, 12, 16),
        'blocks.8.attn.proj.weight':  (16, 12, 12, 16),
        'blocks.8.mlp.fc1.weight':    (32, 24, 12, 16),
        'blocks.8.mlp.fc2.weight':    (16, 12, 24, 32),
        'blocks.9.attn.qkv.weight':   (24, 24, 12, 16),
        'blocks.9.attn.proj.weight':  (16, 12, 12, 16),
        'blocks.9.mlp.fc1.weight':    (32, 24, 12, 16),
        'blocks.9.mlp.fc2.weight':    (16, 12, 24, 32),
        'blocks.10.attn.qkv.weight':  (24, 24, 12, 16),
        'blocks.10.attn.proj.weight': (16, 12, 12, 16),
        'blocks.10.mlp.fc1.weight':   (32, 24, 12, 16),
        'blocks.10.mlp.fc2.weight':   (16, 12, 24, 32),
        'blocks.11.attn.qkv.weight':  (24, 24, 12, 16),
        'blocks.11.attn.proj.weight': (16, 12, 12, 16),
        'blocks.11.mlp.fc1.weight':   (32, 24, 12, 16),
        'blocks.11.mlp.fc2.weight':   (16, 12, 24, 32),
    }

    ranks = {
        # state_dict key: (output channel, input channel)
        'blocks.0.attn.qkv.weight':   (1, 22, 162, 15, 1),
        'blocks.0.attn.proj.weight':  (1, 15, 160, 15, 1),
        'blocks.0.mlp.fc1.weight':    (1, 30, 160, 15, 1),
        'blocks.0.mlp.fc2.weight':    (1, 15, 160, 30, 1),
        'blocks.1.attn.qkv.weight':   (1, 20, 150, 12, 1),
        'blocks.1.attn.proj.weight':  (1, 12, 150, 12, 1),
        'blocks.1.mlp.fc1.weight':    (1, 28, 150, 12, 1),
        'blocks.1.mlp.fc2.weight':    (1, 12, 150, 28, 1),
        'blocks.2.attn.qkv.weight':   (1, 16, 130, 12, 1),
        'blocks.2.attn.proj.weight':  (1, 12, 130, 12, 1),
        'blocks.2.mlp.fc1.weight':    (1, 22, 130, 12, 1),
        'blocks.2.mlp.fc2.weight':    (1, 12, 130, 22, 1),
        'blocks.3.attn.qkv.weight':   (1, 16, 120, 12, 1),
        'blocks.3.attn.proj.weight':  (1, 12, 120, 12, 1),
        'blocks.3.mlp.fc1.weight':    (1, 22, 120, 12, 1),
        'blocks.3.mlp.fc2.weight':    (1, 12, 120, 22, 1),
        'blocks.4.attn.qkv.weight':   (1, 16, 120, 12, 1),
        'blocks.4.attn.proj.weight':  (1, 12, 120, 12, 1),
        'blocks.4.mlp.fc1.weight':    (1, 22, 120, 12, 1),
        'blocks.4.mlp.fc2.weight':    (1, 12, 120, 22, 1),
        'blocks.5.attn.qkv.weight':   (1, 16, 120, 12, 1),
        'blocks.5.attn.proj.weight':  (1, 12, 120, 12, 1),
        'blocks.5.mlp.fc1.weight':    (1, 22, 120, 12, 1),
        'blocks.5.mlp.fc2.weight':    (1, 12, 120, 22, 1),
        'blocks.6.attn.qkv.weight':   (1, 16, 120, 12, 1),
        'blocks.6.attn.proj.weight':  (1, 12, 120, 12, 1),
        'blocks.6.mlp.fc1.weight':    (1, 22, 120, 12, 1),
        'blocks.6.mlp.fc2.weight':    (1, 12, 120, 22, 1),
        'blocks.7.attn.qkv.weight':   (1, 16, 120, 12, 1),
        'blocks.7.attn.proj.weight':  (1, 12, 120, 12, 1),
        'blocks.7.mlp.fc1.weight':    (1, 22, 120, 12, 1),
        'blocks.7.mlp.fc2.weight':    (1, 12, 120, 22, 1),
        'blocks.8.attn.qkv.weight':   (1, 16, 120, 12, 1),
        'blocks.8.attn.proj.weight':  (1, 12, 120, 12, 1),
        'blocks.8.mlp.fc1.weight':    (1, 22, 120, 12, 1),
        'blocks.8.mlp.fc2.weight':    (1, 12, 120, 22, 1),
        'blocks.9.attn.qkv.weight':   (1, 16, 120, 12, 1),
        'blocks.9.attn.proj.weight':  (1, 12, 120, 12, 1),
        'blocks.9.mlp.fc1.weight':    (1, 22, 120, 12, 1),
        'blocks.9.mlp.fc2.weight':    (1, 12, 120, 22, 1),
        'blocks.10.attn.qkv.weight':  (1, 16, 120, 12, 1),
        'blocks.10.attn.proj.weight': (1, 12, 120, 12, 1),
        'blocks.10.mlp.fc1.weight':   (1, 22, 120, 12, 1),
        'blocks.10.mlp.fc2.weight':   (1, 12, 120, 22, 1),
        'blocks.11.attn.qkv.weight':  (1, 16, 110, 12, 1),
        'blocks.11.attn.proj.weight': (1, 12, 110, 12, 1),
        'blocks.11.mlp.fc1.weight':   (1, 22, 110, 12, 1),
        'blocks.11.mlp.fc2.weight':   (1, 12, 110, 22, 1),
    }